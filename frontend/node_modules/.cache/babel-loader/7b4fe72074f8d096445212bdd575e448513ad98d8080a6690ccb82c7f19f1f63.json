{"ast":null,"code":"// src/components/Header.jsx\nimport React,{useState,useEffect}from'react';import'./Header.css';import Modal from'./modal';import{signOut,onAuthStateChanged}from'firebase/auth';import{auth}from\"../firebase\";// removed registerTokenForUser import because we call setupAutoRegistration centrally\nimport{setupAutoRegistration,removeTokenForUser}from\"../firebaseMessaging\";import Login from\"./Login\";import SignUp from\"./SignUp\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function Header(_ref){let{isLoginModalOpen,setIsLoginModalOpen}=_ref;const[isSignupModalOpen,setIsSignupModalOpen]=useState(false);const[user,setUser]=useState(null);useEffect(()=>{const unsub=onAuthStateChanged(auth,async u=>{setUser(u||null);// update UI state\nif(u){try{// setupAutoRegistration will request permission and register token for this uid\nawait setupAutoRegistration({uid:u.uid});}catch(err){console.warn('FCM token registration failed:',err);}}});return()=>{try{unsub();}catch(_){}};},[]);const handleLogout=()=>{var _auth$currentUser;const uid=(_auth$currentUser=auth.currentUser)===null||_auth$currentUser===void 0?void 0:_auth$currentUser.uid;signOut(auth).then(async()=>{if(uid)await removeTokenForUser(uid);console.log(\"User logged out, token removed\");}).catch(error=>{console.error(\"Logout error\",error);});};return/*#__PURE__*/_jsxs(\"header\",{className:\"header\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"container\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"header-contents\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"logo\",children:/*#__PURE__*/_jsx(\"h1\",{children:\"LifeLink\"})}),/*#__PURE__*/_jsx(\"nav\",{className:\"nav\",children:/*#__PURE__*/_jsxs(\"ul\",{children:[/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsx(\"a\",{href:\"#home\",children:\"Home\"})}),/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsx(\"a\",{href:\"#search\",children:\"Find Donors\"})}),/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsx(\"a\",{href:\"#register\",children:\"Register\"})}),/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsx(\"a\",{href:\"#about\",children:\"About\"})}),/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsx(\"a\",{href:\"tel:011-23359379\",className:\"emergency-button\",children:\"Emergency\"})})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"user-login\",children:/*#__PURE__*/_jsx(\"ul\",{children:/*#__PURE__*/_jsx(\"li\",{children:user?/*#__PURE__*/_jsx(\"button\",{onClick:handleLogout,className:\"logout-btn\",children:\"Logout\"}):/*#__PURE__*/_jsx(\"a\",{href:\"#\",onClick:e=>{e.preventDefault();setIsLoginModalOpen(true);},children:\"Login\"})})})}),/*#__PURE__*/_jsxs(\"button\",{className:\"mobile-menu-toggle\",\"aria-label\":\"Toggle-mobile-view\",children:[/*#__PURE__*/_jsx(\"span\",{}),/*#__PURE__*/_jsx(\"span\",{}),/*#__PURE__*/_jsx(\"span\",{})]})]})}),/*#__PURE__*/_jsx(Modal,{isOpen:isLoginModalOpen,onClose:()=>setIsLoginModalOpen(false),children:/*#__PURE__*/_jsx(Login,{onOpenRegister:()=>{setIsLoginModalOpen(false);setIsSignupModalOpen(true);},closeLoginModal:()=>setIsLoginModalOpen(false)})}),/*#__PURE__*/_jsx(Modal,{isOpen:isSignupModalOpen,onClose:()=>setIsSignupModalOpen(false),children:/*#__PURE__*/_jsx(SignUp,{onOpenLogin:()=>{setIsSignupModalOpen(false);setIsLoginModalOpen(true);},onClose:()=>setIsSignupModalOpen(false)})})]});}export default Header;","map":{"version":3,"names":["React","useState","useEffect","Modal","signOut","onAuthStateChanged","auth","setupAutoRegistration","removeTokenForUser","Login","SignUp","jsx","_jsx","jsxs","_jsxs","Header","_ref","isLoginModalOpen","setIsLoginModalOpen","isSignupModalOpen","setIsSignupModalOpen","user","setUser","unsub","u","uid","err","console","warn","_","handleLogout","_auth$currentUser","currentUser","then","log","catch","error","className","children","href","onClick","e","preventDefault","isOpen","onClose","onOpenRegister","closeLoginModal","onOpenLogin"],"sources":["C:/Users/rajya/Desktop/Coding/WebDev/Programs/mini_project_LifeLink/blood-donor-finder/frontend/src/components/Header.jsx"],"sourcesContent":["// src/components/Header.jsx\r\nimport React, { useState, useEffect } from 'react';\r\nimport './Header.css';\r\nimport Modal from './modal';\r\nimport { signOut, onAuthStateChanged } from 'firebase/auth';\r\nimport { auth } from \"../firebase\";\r\n// removed registerTokenForUser import because we call setupAutoRegistration centrally\r\nimport { setupAutoRegistration, removeTokenForUser } from \"../firebaseMessaging\";\r\nimport Login from \"./Login\";\r\nimport SignUp from \"./SignUp\";\r\n\r\nfunction Header({ isLoginModalOpen, setIsLoginModalOpen }) {\r\n  const [isSignupModalOpen, setIsSignupModalOpen] = useState(false);\r\n  const [user, setUser] = useState(null);\r\n\r\n  useEffect(() => {\r\n    const unsub = onAuthStateChanged(auth, async (u) => {\r\n      setUser(u || null); // update UI state\r\n\r\n      if (u) {\r\n        try {\r\n          // setupAutoRegistration will request permission and register token for this uid\r\n          await setupAutoRegistration({ uid: u.uid });\r\n        } catch (err) {\r\n          console.warn('FCM token registration failed:', err);\r\n        }\r\n      }\r\n    });\r\n\r\n    return () => {\r\n      try { unsub(); } catch (_) {}\r\n    };\r\n  }, []);\r\n\r\n  const handleLogout = () => {\r\n    const uid = auth.currentUser?.uid;\r\n\r\n    signOut(auth)\r\n      .then(async () => {\r\n        if (uid) await removeTokenForUser(uid);\r\n        console.log(\"User logged out, token removed\");\r\n      })\r\n      .catch(error => {\r\n        console.error(\"Logout error\", error);\r\n      });\r\n  };\r\n\r\n  return (\r\n    <header className=\"header\">\r\n      <div className=\"container\">\r\n        <div className=\"header-contents\">\r\n          <div className=\"logo\"><h1>LifeLink</h1></div>\r\n\r\n          <nav className=\"nav\">\r\n            <ul>\r\n              <li><a href=\"#home\">Home</a></li>\r\n              <li><a href=\"#search\">Find Donors</a></li>\r\n              <li><a href=\"#register\">Register</a></li>\r\n              <li><a href=\"#about\">About</a></li>\r\n              <li><a href=\"tel:011-23359379\" className=\"emergency-button\">Emergency</a></li>\r\n            </ul>\r\n          </nav>\r\n\r\n          <div className=\"user-login\">\r\n            <ul>\r\n              <li>\r\n                {user ? (\r\n                  <button onClick={handleLogout} className=\"logout-btn\">Logout</button>\r\n                ) : (\r\n                  <a href=\"#\" onClick={e => { e.preventDefault(); setIsLoginModalOpen(true); }}>\r\n                    Login\r\n                  </a>\r\n                )}\r\n              </li>\r\n            </ul>\r\n          </div>\r\n\r\n          <button className=\"mobile-menu-toggle\" aria-label=\"Toggle-mobile-view\">\r\n            <span></span><span></span><span></span>\r\n          </button>\r\n        </div>\r\n      </div>\r\n\r\n      <Modal isOpen={isLoginModalOpen} onClose={() => setIsLoginModalOpen(false)}>\r\n        <Login\r\n          onOpenRegister={() => { setIsLoginModalOpen(false); setIsSignupModalOpen(true); }}\r\n          closeLoginModal={() => setIsLoginModalOpen(false)}\r\n        />\r\n      </Modal>\r\n\r\n      <Modal isOpen={isSignupModalOpen} onClose={() => setIsSignupModalOpen(false)}>\r\n        <SignUp\r\n          onOpenLogin={() => { setIsSignupModalOpen(false); setIsLoginModalOpen(true); }}\r\n          onClose={() => setIsSignupModalOpen(false)}\r\n        />\r\n      </Modal>\r\n    </header>\r\n  );\r\n}\r\n\r\nexport default Header;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}