{"ast":null,"code":"// src/firebaseMessaging.js\nimport { getMessaging, getToken, onMessage } from \"firebase/messaging\";\nimport { getAuth } from \"firebase/auth\";\nimport { doc, setDoc } from \"firebase/firestore\";\nimport { db } from \"./firebase\"; // your exports: app, auth, db\n\nconst VAPID_KEY = \"BIO2Mc6NhNj7m9xAN8OctwR5lWFytEx-1cnnjpqTTWHeJBPbwg0Qo4LbbVrEmmkfjju5835EtZD03Mgmo7K1dmc\"; // the vapid key you saw\n\nexport async function registerTokenForUser(uid) {\n  try {\n    const messaging = getMessaging();\n    const token = await getToken(messaging, {\n      vapidKey: VAPID_KEY\n    });\n    if (token) {\n      // Save token in Firestore - collection UserTokens or DonorTokens\n      await setDoc(doc(db, \"UserTokens\", uid), {\n        token,\n        updatedAt: new Date().toISOString()\n      });\n      console.log(\"Saved FCM token:\", token);\n      return token;\n    }\n    console.log(\"No token received (permission maybe declined)\");\n    return null;\n  } catch (e) {\n    console.error(\"registerTokenForUser error\", e);\n    return null;\n  }\n}\nexport function listenForegroundMessages(callback) {\n  const messaging = getMessaging();\n  onMessage(messaging, payload => {\n    console.log(\"Foreground message\", payload);\n    if (callback) callback(payload);\n  });\n}","map":{"version":3,"names":["getMessaging","getToken","onMessage","getAuth","doc","setDoc","db","VAPID_KEY","registerTokenForUser","uid","messaging","token","vapidKey","updatedAt","Date","toISOString","console","log","e","error","listenForegroundMessages","callback","payload"],"sources":["C:/Users/rajya/Desktop/Coding/WebDev/Programs/mini_project_LifeLink/blood-donor-finder/frontend/src/firebaseMessaging.js"],"sourcesContent":["\r\n// src/firebaseMessaging.js\r\nimport { getMessaging, getToken, onMessage } from \"firebase/messaging\";\r\nimport { getAuth } from \"firebase/auth\";\r\nimport { doc, setDoc } from \"firebase/firestore\";\r\nimport { db } from \"./firebase\"; // your exports: app, auth, db\r\n\r\nconst VAPID_KEY = \"BIO2Mc6NhNj7m9xAN8OctwR5lWFytEx-1cnnjpqTTWHeJBPbwg0Qo4LbbVrEmmkfjju5835EtZD03Mgmo7K1dmc\"; // the vapid key you saw\r\n\r\nexport async function registerTokenForUser(uid) {\r\n  try {\r\n    const messaging = getMessaging();\r\n    const token = await getToken(messaging, { vapidKey: VAPID_KEY });\r\n    if (token) {\r\n      // Save token in Firestore - collection UserTokens or DonorTokens\r\n      await setDoc(doc(db, \"UserTokens\", uid), { token, updatedAt: new Date().toISOString() });\r\n      console.log(\"Saved FCM token:\", token);\r\n      return token;\r\n    }\r\n    console.log(\"No token received (permission maybe declined)\");\r\n    return null;\r\n  } catch (e) {\r\n    console.error(\"registerTokenForUser error\", e);\r\n    return null;\r\n  }\r\n}\r\n\r\nexport function listenForegroundMessages(callback) {\r\n  const messaging = getMessaging();\r\n  onMessage(messaging, (payload) => {\r\n    console.log(\"Foreground message\", payload);\r\n    if (callback) callback(payload);\r\n  });\r\n}\r\n"],"mappings":"AACA;AACA,SAASA,YAAY,EAAEC,QAAQ,EAAEC,SAAS,QAAQ,oBAAoB;AACtE,SAASC,OAAO,QAAQ,eAAe;AACvC,SAASC,GAAG,EAAEC,MAAM,QAAQ,oBAAoB;AAChD,SAASC,EAAE,QAAQ,YAAY,CAAC,CAAC;;AAEjC,MAAMC,SAAS,GAAG,yFAAyF,CAAC,CAAC;;AAE7G,OAAO,eAAeC,oBAAoBA,CAACC,GAAG,EAAE;EAC9C,IAAI;IACF,MAAMC,SAAS,GAAGV,YAAY,CAAC,CAAC;IAChC,MAAMW,KAAK,GAAG,MAAMV,QAAQ,CAACS,SAAS,EAAE;MAAEE,QAAQ,EAAEL;IAAU,CAAC,CAAC;IAChE,IAAII,KAAK,EAAE;MACT;MACA,MAAMN,MAAM,CAACD,GAAG,CAACE,EAAE,EAAE,YAAY,EAAEG,GAAG,CAAC,EAAE;QAAEE,KAAK;QAAEE,SAAS,EAAE,IAAIC,IAAI,CAAC,CAAC,CAACC,WAAW,CAAC;MAAE,CAAC,CAAC;MACxFC,OAAO,CAACC,GAAG,CAAC,kBAAkB,EAAEN,KAAK,CAAC;MACtC,OAAOA,KAAK;IACd;IACAK,OAAO,CAACC,GAAG,CAAC,+CAA+C,CAAC;IAC5D,OAAO,IAAI;EACb,CAAC,CAAC,OAAOC,CAAC,EAAE;IACVF,OAAO,CAACG,KAAK,CAAC,4BAA4B,EAAED,CAAC,CAAC;IAC9C,OAAO,IAAI;EACb;AACF;AAEA,OAAO,SAASE,wBAAwBA,CAACC,QAAQ,EAAE;EACjD,MAAMX,SAAS,GAAGV,YAAY,CAAC,CAAC;EAChCE,SAAS,CAACQ,SAAS,EAAGY,OAAO,IAAK;IAChCN,OAAO,CAACC,GAAG,CAAC,oBAAoB,EAAEK,OAAO,CAAC;IAC1C,IAAID,QAAQ,EAAEA,QAAQ,CAACC,OAAO,CAAC;EACjC,CAAC,CAAC;AACJ","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}