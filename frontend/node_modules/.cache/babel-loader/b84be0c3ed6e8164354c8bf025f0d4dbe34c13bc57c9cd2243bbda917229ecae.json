{"ast":null,"code":"// src/App.js\nimport React,{useState,useCallback,useRef,useEffect}from\"react\";import{setupAutoRegistration,initMessaging}from\"./firebaseMessaging\";import{ToastContainer}from\"react-toastify\";import\"react-toastify/dist/ReactToastify.css\";import{onAuthStateChanged}from\"firebase/auth\";import{auth}from\"./firebase\";import Header from\"./components/Header\";import Hero from\"./components/Hero\";import Search from\"./components/Search\";import SearchResult from\"./components/SearchResult\";import Register from\"./components/Register\";import About from\"./components/About\";import Footer from\"./components/Footer\";import ContactModal from\"./components/ContactModal\";import DonorMap from\"./components/DonorMap\";import Signup from\"./components/SignUp\";// added\nimport\"./styles/global.css\";import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";function App(){const[isLoginModalOpen,setIsLoginModalOpen]=useState(false);// signup modal state + helpers\nconst[isSignupOpen,setIsSignupOpen]=useState(false);const openSignup=()=>setIsSignupOpen(true);const closeSignup=()=>setIsSignupOpen(false);const[searchResults,setSearchResults]=useState([]);const[recipientLocation,setRecipientLocation]=useState(null);const[userHasSearched,setUserHasSearched]=useState(false);const[mapController,setMapControllerState]=useState(null);const pendingFocusRef=useRef([]);useEffect(()=>{// initialize messaging service worker + messaging instance once\n// (we call initMessaging with default app which you export from ./firebase)\ninitMessaging().catch(e=>{console.warn(\"initMessaging failed:\",e);});// register for auth changes; when user signs in, register FCM token\nconst unsubscribe=onAuthStateChanged(auth,async user=>{console.log('onAuthStateChanged fired. auth:',auth);console.log('onAuthStateChanged fired. user (raw):',user);// defensive: if user exists but uid is missing, log that explicitly\nif(user&&typeof user.uid==='undefined'){console.warn('onAuthStateChanged: user object has no uid property:',user);}if(user){try{// pass the uid explicitly so setupAutoRegistration doesn't throw\nawait setupAutoRegistration({uid:user.uid});}catch(e){console.warn(\"setupAutoRegistration failed:\",e);}}else{// user signed out - token cleanup already handled elsewhere (Register.jsx), but you can do extra cleanup here if desired\n}});return()=>{try{unsubscribe();}catch(_){}};},[]);const handleSetMapController=useCallback(controller=>{setMapControllerState(controller);if(controller&&pendingFocusRef.current.length>0){pendingFocusRef.current.forEach(_ref=>{let{lat,lng,zoom}=_ref;try{controller.focusOn(lat,lng,zoom);}catch(_){}});pendingFocusRef.current=[];}},[]);const focusOn=useCallback(function(lat,lng){let zoom=arguments.length>2&&arguments[2]!==undefined?arguments[2]:15;if(mapController&&typeof mapController.focusOn===\"function\"){mapController.focusOn(lat,lng,zoom);}else{pendingFocusRef.current.push({lat,lng,zoom});}},[mapController]);return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(Header,{isLoginModalOpen:isLoginModalOpen,setIsLoginModalOpen:setIsLoginModalOpen// optionally expose signup opener to Header if you want:\n,openSignup:openSignup}),/*#__PURE__*/_jsx(Hero,{}),/*#__PURE__*/_jsx(Search,{setResults:setSearchResults,setRecipientLocation:setRecipientLocation,setUserHasSearched:setUserHasSearched}),recipientLocation&&/*#__PURE__*/_jsx(DonorMap,{recipientLocation:recipientLocation,donors:searchResults,setMapController:handleSetMapController}),userHasSearched&&/*#__PURE__*/_jsx(SearchResult,{results:searchResults,focusOn:focusOn}),/*#__PURE__*/_jsx(Register,{setIsLoginModalOpen:setIsLoginModalOpen}),/*#__PURE__*/_jsx(About,{}),/*#__PURE__*/_jsx(Footer,{}),/*#__PURE__*/_jsx(ContactModal,{})]}),isSignupOpen&&/*#__PURE__*/_jsx(\"div\",{className:\"modal\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"modal-content\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"modal-close\",onClick:closeSignup,children:\"\\xD7\"}),/*#__PURE__*/_jsx(Signup,{onOpenLogin:()=>{// user clicked \"Login\" inside Signup: close signup modal and open login modal\ncloseSignup();setIsLoginModalOpen(true);},onClose:closeSignup})]})}),/*#__PURE__*/_jsx(ToastContainer,{})]});}export default App;","map":{"version":3,"names":["React","useState","useCallback","useRef","useEffect","setupAutoRegistration","initMessaging","ToastContainer","onAuthStateChanged","auth","Header","Hero","Search","SearchResult","Register","About","Footer","ContactModal","DonorMap","Signup","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","App","isLoginModalOpen","setIsLoginModalOpen","isSignupOpen","setIsSignupOpen","openSignup","closeSignup","searchResults","setSearchResults","recipientLocation","setRecipientLocation","userHasSearched","setUserHasSearched","mapController","setMapControllerState","pendingFocusRef","catch","e","console","warn","unsubscribe","user","log","uid","_","handleSetMapController","controller","current","length","forEach","_ref","lat","lng","zoom","focusOn","arguments","undefined","push","children","setResults","donors","setMapController","results","className","onClick","onOpenLogin","onClose"],"sources":["C:/Users/rajya/Desktop/Coding/WebDev/Programs/mini_project_LifeLink/blood-donor-finder/frontend/src/App.js"],"sourcesContent":["// src/App.js\nimport React, { useState, useCallback, useRef, useEffect } from \"react\";\nimport { setupAutoRegistration, initMessaging } from \"./firebaseMessaging\";\nimport { ToastContainer } from \"react-toastify\";\nimport \"react-toastify/dist/ReactToastify.css\";\nimport { onAuthStateChanged } from \"firebase/auth\";\nimport { auth } from \"./firebase\";\n\nimport Header from \"./components/Header\";\nimport Hero from \"./components/Hero\";\nimport Search from \"./components/Search\";\nimport SearchResult from \"./components/SearchResult\";\nimport Register from \"./components/Register\";\nimport About from \"./components/About\";\nimport Footer from \"./components/Footer\";\nimport ContactModal from \"./components/ContactModal\";\nimport DonorMap from \"./components/DonorMap\";\nimport Signup from \"./components/SignUp\"; // added\n\nimport \"./styles/global.css\";\n\nfunction App() {\n  const [isLoginModalOpen, setIsLoginModalOpen] = useState(false);\n\n  // signup modal state + helpers\n  const [isSignupOpen, setIsSignupOpen] = useState(false);\n  const openSignup = () => setIsSignupOpen(true);\n  const closeSignup = () => setIsSignupOpen(false);\n\n  const [searchResults, setSearchResults] = useState([]);\n  const [recipientLocation, setRecipientLocation] = useState(null);\n\n  const [userHasSearched, setUserHasSearched] = useState(false);\n\n  const [mapController, setMapControllerState] = useState(null);\n  const pendingFocusRef = useRef([]);\n\n  useEffect(() => {\n      // initialize messaging service worker + messaging instance once\n      // (we call initMessaging with default app which you export from ./firebase)\n      initMessaging().catch((e) => {\n        console.warn(\"initMessaging failed:\", e);\n      });\n\n      // register for auth changes; when user signs in, register FCM token\n      const unsubscribe = onAuthStateChanged(auth, async (user) => {\n        console.log('onAuthStateChanged fired. auth:', auth);\n        console.log('onAuthStateChanged fired. user (raw):', user);\n        // defensive: if user exists but uid is missing, log that explicitly\n        if (user && typeof user.uid === 'undefined') {\n          console.warn('onAuthStateChanged: user object has no uid property:', user);\n        }\n\n        if (user) {\n          try {\n            // pass the uid explicitly so setupAutoRegistration doesn't throw\n            await setupAutoRegistration({ uid: user.uid });\n          } catch (e) {\n            console.warn(\"setupAutoRegistration failed:\", e);\n          }\n        } else {\n          // user signed out - token cleanup already handled elsewhere (Register.jsx), but you can do extra cleanup here if desired\n        }\n      });\n\n\n\n      return () => {\n        try { unsubscribe(); } catch(_) {}\n      };\n    }, []);\n\n  const handleSetMapController = useCallback((controller) => {\n    setMapControllerState(controller);\n\n    if (controller && pendingFocusRef.current.length > 0) {\n      pendingFocusRef.current.forEach(({ lat, lng, zoom }) => {\n        try {\n          controller.focusOn(lat, lng, zoom);\n        } catch (_) {}\n      });\n      pendingFocusRef.current = [];\n    }\n  }, []);\n\n  const focusOn = useCallback(\n    (lat, lng, zoom = 15) => {\n      if (mapController && typeof mapController.focusOn === \"function\") {\n        mapController.focusOn(lat, lng, zoom);\n      } else {\n        pendingFocusRef.current.push({ lat, lng, zoom });\n      }\n    },\n    [mapController]\n  );\n\n  return (\n    <>\n      <div>\n        <Header\n          isLoginModalOpen={isLoginModalOpen}\n          setIsLoginModalOpen={setIsLoginModalOpen}\n          // optionally expose signup opener to Header if you want:\n          openSignup={openSignup}\n        />\n\n        <Hero />\n\n        <Search\n          setResults={setSearchResults}\n          setRecipientLocation={setRecipientLocation}\n          setUserHasSearched={setUserHasSearched}\n        />\n\n        {recipientLocation && (\n          <DonorMap\n            recipientLocation={recipientLocation}\n            donors={searchResults}\n            setMapController={handleSetMapController}\n          />\n        )}\n\n        {userHasSearched && <SearchResult results={searchResults} focusOn={focusOn} />}\n\n        <Register setIsLoginModalOpen={setIsLoginModalOpen} />\n        <About />\n        <Footer />\n        <ContactModal />\n      </div>\n\n      {/* Signup modal wrapper â€” parent provides onClose so Signup can close itself */}\n      {isSignupOpen && (\n        <div className=\"modal\">\n          <div className=\"modal-content\">\n            <button className=\"modal-close\" onClick={closeSignup}>\n              &times;\n            </button>\n\n            <Signup\n              onOpenLogin={() => {\n                // user clicked \"Login\" inside Signup: close signup modal and open login modal\n                closeSignup();\n                setIsLoginModalOpen(true);\n              }}\n              onClose={closeSignup}\n            />\n          </div>\n        </div>\n      )}\n\n      <ToastContainer />\n    </>\n  );\n}\n\nexport default App;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}