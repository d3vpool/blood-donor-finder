{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\rajya\\\\Desktop\\\\Coding\\\\WebDev\\\\Programs\\\\mini_project_LifeLink\\\\blood-donor-finder\\\\frontend\\\\src\\\\components\\\\DonorMap.jsx\",\n  _s = $RefreshSig$();\n// DonorMap.jsx — use this exact file\nimport React, { useEffect, useRef } from \"react\";\nimport { GoogleMap, useJsApiLoader } from \"@react-google-maps/api\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst containerStyle = {\n  width: \"100%\",\n  height: \"400px\"\n};\nexport default function DonorMap({\n  recipientLocation,\n  donors = []\n}) {\n  _s();\n  const mapRef = useRef(null);\n  const markersRef = useRef([]);\n  const apiKey = process.env.REACT_APP_GOOGLE_MAPS_API_KEY;\n  const {\n    isLoaded,\n    loadError\n  } = useJsApiLoader({\n    googleMapsApiKey: apiKey\n  });\n  const normalized = (() => {\n    if (!recipientLocation) return null;\n    if (typeof recipientLocation.latitude === \"number\") return {\n      lat: Number(recipientLocation.latitude),\n      lng: Number(recipientLocation.longitude)\n    };\n    if (typeof recipientLocation.lat === \"number\") return {\n      lat: Number(recipientLocation.lat),\n      lng: Number(recipientLocation.lng)\n    };\n    if (recipientLocation.coords && typeof recipientLocation.coords.latitude === \"number\") return {\n      lat: Number(recipientLocation.coords.latitude),\n      lng: Number(recipientLocation.coords.longitude)\n    };\n    return null;\n  })();\n  useEffect(() => {\n    if (!isLoaded || !mapRef.current) return;\n    const map = mapRef.current;\n\n    // clear old markers\n    markersRef.current.forEach(m => m.setMap(null));\n    markersRef.current = [];\n\n    // helper: SVG data URL icon → no external image dependency\n    const makeSvgIcon = (color, label) => {\n      const svg = encodeURIComponent(`<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"32\" height=\"32\">\n           <circle cx=\"16\" cy=\"12\" r=\"8\" fill=\"${color}\" />\n           <rect x=\"8\" y=\"20\" width=\"16\" height=\"4\" fill=\"${color}\" rx=\"2\" />\n           <text x=\"16\" y=\"18\" font-size=\"10\" text-anchor=\"middle\" fill=\"#FFF\">${label || ''}</text>\n         </svg>`);\n      return {\n        url: `data:image/svg+xml;charset=UTF-8,${svg}`,\n        scaledSize: new window.google.maps.Size(32, 32)\n      };\n    };\n\n    // fallback marker (always)\n    /* const fallback = new window.google.maps.Marker({\r\n      position: { lat: 12.9716, lng: 77.5946 },\r\n      map,\r\n      title: \"FALLBACK\",\r\n      icon: makeSvgIcon('#1976D2','F')\r\n    });\r\n    markersRef.current.push(fallback); */\n\n    if (normalized) {\n      const userMarker = new window.google.maps.Marker({\n        position: normalized,\n        map,\n        title: \"YOU\",\n        icon: makeSvgIcon('#ff5252', 'U'),\n        zIndex: 9999\n      });\n      markersRef.current.push(userMarker);\n      map.setCenter(normalized);\n      map.setZoom(13);\n    }\n    donors.forEach((d, i) => {\n      var _d$location, _d$location2;\n      const lat = Number(d === null || d === void 0 ? void 0 : (_d$location = d.location) === null || _d$location === void 0 ? void 0 : _d$location.latitude);\n      const lng = Number(d === null || d === void 0 ? void 0 : (_d$location2 = d.location) === null || _d$location2 === void 0 ? void 0 : _d$location2.longitude);\n      if (Number.isNaN(lat) || Number.isNaN(lng)) return;\n      const mk = new window.google.maps.Marker({\n        position: {\n          lat,\n          lng\n        },\n        map,\n        title: d.name || `donor-${i}`,\n        icon: makeSvgIcon('#4caf50', String(i + 1))\n      });\n      markersRef.current.push(mk);\n    });\n    setTimeout(() => {\n      console.log('Force markers placed. Center:', map.getCenter() && map.getCenter().toJSON(), 'zoom:', map.getZoom());\n    }, 200);\n    return () => {\n      markersRef.current.forEach(m => m && m.setMap(null));\n      markersRef.current = [];\n    };\n  }, [isLoaded, normalized, donors]);\n  if (loadError) return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [\"Map load error: \", String(loadError)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 86,\n    columnNumber: 25\n  }, this);\n  if (!isLoaded) return null;\n  return /*#__PURE__*/_jsxDEV(GoogleMap, {\n    mapContainerStyle: containerStyle,\n    center: normalized || {\n      lat: 12.9716,\n      lng: 77.5946\n    },\n    zoom: normalized ? 13 : 11,\n    onLoad: m => mapRef.current = m\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 90,\n    columnNumber: 5\n  }, this);\n}\n_s(DonorMap, \"xP4AroEvmd4HEmgVEtkKaDcsI28=\", false, function () {\n  return [useJsApiLoader];\n});\n_c = DonorMap;\nvar _c;\n$RefreshReg$(_c, \"DonorMap\");","map":{"version":3,"names":["React","useEffect","useRef","GoogleMap","useJsApiLoader","jsxDEV","_jsxDEV","containerStyle","width","height","DonorMap","recipientLocation","donors","_s","mapRef","markersRef","apiKey","process","env","REACT_APP_GOOGLE_MAPS_API_KEY","isLoaded","loadError","googleMapsApiKey","normalized","latitude","lat","Number","lng","longitude","coords","current","map","forEach","m","setMap","makeSvgIcon","color","label","svg","encodeURIComponent","url","scaledSize","window","google","maps","Size","userMarker","Marker","position","title","icon","zIndex","push","setCenter","setZoom","d","i","_d$location","_d$location2","location","isNaN","mk","name","String","setTimeout","console","log","getCenter","toJSON","getZoom","children","fileName","_jsxFileName","lineNumber","columnNumber","mapContainerStyle","center","zoom","onLoad","_c","$RefreshReg$"],"sources":["C:/Users/rajya/Desktop/Coding/WebDev/Programs/mini_project_LifeLink/blood-donor-finder/frontend/src/components/DonorMap.jsx"],"sourcesContent":["// DonorMap.jsx — use this exact file\r\nimport React, { useEffect, useRef } from \"react\";\r\nimport { GoogleMap, useJsApiLoader } from \"@react-google-maps/api\";\r\n\r\nconst containerStyle = { width: \"100%\", height: \"400px\" };\r\n\r\nexport default function DonorMap({ recipientLocation, donors = [] }) {\r\n  const mapRef = useRef(null);\r\n  const markersRef = useRef([]);\r\n  const apiKey = process.env.REACT_APP_GOOGLE_MAPS_API_KEY;\r\n  const { isLoaded, loadError } = useJsApiLoader({ googleMapsApiKey: apiKey });\r\n\r\n  const normalized = (() => {\r\n    if (!recipientLocation) return null;\r\n    if (typeof recipientLocation.latitude === \"number\") return { lat: Number(recipientLocation.latitude), lng: Number(recipientLocation.longitude) };\r\n    if (typeof recipientLocation.lat === \"number\") return { lat: Number(recipientLocation.lat), lng: Number(recipientLocation.lng) };\r\n    if (recipientLocation.coords && typeof recipientLocation.coords.latitude === \"number\") return { lat: Number(recipientLocation.coords.latitude), lng: Number(recipientLocation.coords.longitude) };\r\n    return null;\r\n  })();\r\n\r\n  useEffect(() => {\r\n    if (!isLoaded || !mapRef.current) return;\r\n    const map = mapRef.current;\r\n\r\n    // clear old markers\r\n    markersRef.current.forEach(m => m.setMap(null));\r\n    markersRef.current = [];\r\n\r\n    // helper: SVG data URL icon → no external image dependency\r\n    const makeSvgIcon = (color, label) => {\r\n      const svg = encodeURIComponent(\r\n        `<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"32\" height=\"32\">\r\n           <circle cx=\"16\" cy=\"12\" r=\"8\" fill=\"${color}\" />\r\n           <rect x=\"8\" y=\"20\" width=\"16\" height=\"4\" fill=\"${color}\" rx=\"2\" />\r\n           <text x=\"16\" y=\"18\" font-size=\"10\" text-anchor=\"middle\" fill=\"#FFF\">${label||''}</text>\r\n         </svg>`\r\n      );\r\n      return { url: `data:image/svg+xml;charset=UTF-8,${svg}`, scaledSize: new window.google.maps.Size(32,32) };\r\n    };\r\n\r\n    // fallback marker (always)\r\n    /* const fallback = new window.google.maps.Marker({\r\n      position: { lat: 12.9716, lng: 77.5946 },\r\n      map,\r\n      title: \"FALLBACK\",\r\n      icon: makeSvgIcon('#1976D2','F')\r\n    });\r\n    markersRef.current.push(fallback); */\r\n\r\n    if (normalized) {\r\n      const userMarker = new window.google.maps.Marker({\r\n        position: normalized,\r\n        map,\r\n        title: \"YOU\",\r\n        icon: makeSvgIcon('#ff5252','U'),\r\n        zIndex: 9999\r\n      });\r\n      markersRef.current.push(userMarker);\r\n      map.setCenter(normalized);\r\n      map.setZoom(13);\r\n    }\r\n\r\n    donors.forEach((d,i) => {\r\n      const lat = Number(d?.location?.latitude);\r\n      const lng = Number(d?.location?.longitude);\r\n      if (Number.isNaN(lat) || Number.isNaN(lng)) return;\r\n      const mk = new window.google.maps.Marker({\r\n        position: { lat, lng },\r\n        map,\r\n        title: d.name || `donor-${i}`,\r\n        icon: makeSvgIcon('#4caf50', String(i+1))\r\n      });\r\n      markersRef.current.push(mk);\r\n    });\r\n\r\n    setTimeout(() => {\r\n      console.log('Force markers placed. Center:', map.getCenter() && map.getCenter().toJSON(), 'zoom:', map.getZoom());\r\n    }, 200);\r\n\r\n    return () => {\r\n      markersRef.current.forEach(m => m && m.setMap(null));\r\n      markersRef.current = [];\r\n    };\r\n  }, [isLoaded, normalized, donors]);\r\n\r\n  if (loadError) return <div>Map load error: {String(loadError)}</div>;\r\n  if (!isLoaded) return null;\r\n\r\n  return (\r\n    <GoogleMap\r\n      mapContainerStyle={containerStyle}\r\n      center={normalized || { lat: 12.9716, lng: 77.5946 }}\r\n      zoom={normalized ? 13 : 11}\r\n      onLoad={(m) => (mapRef.current = m)}\r\n    />\r\n  );\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}